CREATE OR REPLACE TRIGGER TRG_GENERAR_CALENDARIO
BEFORE INSERT OR UPDATE ON JORNADAS
FOR EACH ROW
DECLARE
    V_NUM_JUGADORES NUMBER;
BEGIN
    FOR i IN 1..12
    LOOP
        SELECT COUNT(*) INTO V_NUM_JUGADORES 
        FROM EQUIPOS_JUGADORES 
        GROUP BY ID_EQUIPO HAVING ID_EQUIPO = i;
        IF V_NUM_JUGADORES < 8 THEN
            RAISE_APPLICATION_ERROR(-20003, 'EL EQUIPO CON EL ID: ' || i || 'TIENE MENOS DE 8 JUGADORES, NO SE PUEDE GENERAR LA JORNADA');
        END IF;
    END LOOP;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RAISE_APPLICATION_ERROR(-20004,'NO ESTAN TODOS LOS EQUIPOS');
END;